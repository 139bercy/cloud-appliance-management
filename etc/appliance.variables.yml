bootstrap_htpdate_servers:
   - www.wikipedia.org

bootstrap_http_proxy: "{{ lookup('env', 'HTTP_PROXY') }}"
bootstrap_no_proxy: "{{ lookup('env', 'NO_PROXY') }}"

###############################################################################
# Consul
#
consul_retry_join: "{{ lookup('env', 'CONSUL_SERVERS').split(',') }}"
consul_dns_domain: "{{ lookup('env', 'CONSUL_DNS_DOMAIN') }}"
consul_datacenter: "{{ lookup('env', 'CONSUL_DATACENTER') }}"
consul_http_proxy: "{{ lookup('env', 'HTTP_PROXY') }}"

consul_server_mode: true
consul_consul_bootstrap_expect: "{{ lookup('env', 'CONSUL_BOOTSTRAP_EXPECT') }}"

# Multi-datacenter configuration
#consul_advertise_addr_wan:
#consul_translate_wan_addrs:

###############################################################################
# Vault
#
vault_server_mode: true
vault_http_proxy: "{{ lookup('env', 'HTTP_PROXY') }}"
vault_http_no_proxy: "{{ lookup('env', 'NO_PROXY') }}"

vault_token_store_consul_kv: true
vault_token_store_swift: false

vault_policies:
  # Nomad service vault policy
  - name: nomad-server
    paths:
        - path: auth/token/create/nomad-cluster
          capabilities:
              - update
        - path: auth/token/roles/nomad-cluster
          capabilities:
              - read
        - path: auth/token/lookup-self
          capabilities:
              - read
        - path: auth/token/lookup
          capabilities:
              - update
        - path: auth/token/revoke-accessor
          capabilities:
              - update
        - path: sys/capabilities-self
          capabilities:
              - update
        - path: auth/token/renew-self
          capabilities:
              - update
        - path: auth/token/roles/nomad-server
          capabilities:
              - read
        - path: auth/token/create/nomad-server
          capabilities:
             - update
 
###############################################################################
# Nomad
#
nomad_server_mode: true
nomad_http_proxy: "{{ lookup('env', 'HTTP_PROXY') }}"
nomad_http_no_proxy: "{{ lookup('env', 'NO_PROXY') }}"
